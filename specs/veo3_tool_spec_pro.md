# 🚀 Video Auto Generator Tool — VEO 3 (Pro Spec)

## 🧭 Mục tiêu
Bản mở rộng này nâng cấp từ bản cơ bản, hướng đến:
- Tự động hóa toàn bộ pipeline từ nhập prompt → render → tải → ghép → upload.
- Hỗ trợ render hàng loạt (batch) với khả năng tự phục hồi khi có lỗi.
- Tối ưu hiệu suất bằng multi-thread/multi-tab.
- Dễ dàng cấu hình, quản lý và mở rộng.

---

## 🧰 Tính năng mới

### 1. 🧩 Quản lý phiên đăng nhập thông minh (Session Manager)
- Lưu cookie/session sau lần đăng nhập đầu tiên.
- Tự động nạp session cho các lần chạy sau.
- Phát hiện hết hạn session → tự đăng nhập lại.

### 2. 🧠 Retry & Recovery System
- Tự động retry render tối đa `N` lần.
- Tự chuyển cảnh kế tiếp nếu fail.
- Ghi log cảnh bị lỗi vào file `failed_scenes.csv` để xử lý sau.

### 3. ⏰ Scheduler (Bộ lập lịch)
- Cho phép hẹn giờ chạy batch render.
- Tự động load file CSV theo lịch định sẵn.
- Chạy nhiều batch trong ngày nếu cần.

### 4. ⚡ Multi-tab / Multi-thread Rendering
- Cho phép mở nhiều tab (hoặc thread) song song.
- Giới hạn số tab tối đa để tránh bị khóa tài khoản.
- Quản lý trạng thái từng tab: `rendering`, `completed`, `failed`.

### 5. 📊 Dashboard Console (Realtime)
- Hiển thị bảng trạng thái tất cả các cảnh.
- Thời gian ước tính còn lại.
- Tô màu cảnh lỗi / cảnh hoàn tất.
- Tạo bản summary sau khi batch xong.

### 6. 🧩 Ghép video tự động (Post-process)
- Tự động ghép các cảnh theo thứ tự CSV bằng `ffmpeg` hoặc `moviepy`.
- Thêm nhạc nền mặc định (cấu hình trong file `config.yaml`).
- Tự động xuất file hoàn chỉnh `final_video.mp4`.

### 7. 📤 Upload tự động (Optional)
- Tự động upload file hoàn chỉnh lên các nền tảng:
  - Google Drive
  - TikTok (qua API hoặc tool upload)
  - YouTube (qua API)
- Thêm mô tả, hashtag, thumbnail từ file cấu hình.

### 8. ⚙️ Cấu hình động (Config file)
- Sử dụng `config.yaml` hoặc `.env` để lưu:
  - URL VEO
  - Số tab render
  - Thời gian delay
  - Thư mục output
  - Số lần retry
  - API key (nếu cần upload)
  - Nhạc nền mặc định

### 9. 🧼 Memory & Error Handling
- Tự đóng tab đã hoàn tất.
- Dọn file tạm sau khi ghép.
- Xử lý lỗi Selenium (treo, crash, mất kết nối).

---

## 🧰 Tech Stack Pro

| Hạng mục                    | Công nghệ                            | Ghi chú |
|------------------------------|----------------------------------------|--------|
| Ngôn ngữ chính               | Python                                |         |
| Automation                   | Selenium + webdriver-manager          | Điều khiển VEO UI |
| Multi-thread                 | `threading` hoặc `asyncio`             | Tăng hiệu suất |
| Dashboard                    | `rich` / `textual`                     | Realtime console |
| Ghép video                   | `ffmpeg` hoặc `moviepy`               | Render hậu kỳ |
| Upload                       | `pydrive` / `YouTube API` / custom    | Tự động đưa file lên |
| Cấu hình                     | `PyYAML` / `dotenv`                   | Dễ chỉnh, mở rộng |
| Lập lịch                     | `schedule`                            | Run theo giờ |
| Logging nâng cao             | `logging` + custom handler            | Phân loại log rõ ràng |

---

## 🧭 Quy trình chạy tổng thể

```
Scheduler (tự động) ─► Load CSV ─► Selenium login session ─►
Gửi prompt song song ─► Theo dõi render ─► Download ─►
Ghép video ─► Upload ─► Ghi log ─► Cleanup
```

---

## 📦 Cấu trúc thư mục

```
veo-auto-pro/
├── veo_auto_pro.py
├── requirements.txt
├── scenes.csv
├── config.yaml
├── output/
│   ├── clips/
│   └── final/
├── logs/
│   └── render_log.txt
├── failed_scenes.csv
└── temp/
```

---

## 📄 config.yaml mẫu

```yaml
veo_url: "https://flow.google.com/veo"
max_tabs: 3
retry_count: 2
delay_between_tasks: 5
output_path: "./output"
background_music: "./assets/bgm.mp3"

upload:
  drive: true
  youtube: false
  tiktok: false

youtube:
  api_key: "YOUR_KEY"
  title: "Trailer Match Day"
  description: "Video generated by VEO Pro Tool"
```

---

## 🧪 Kế hoạch kiểm thử nâng cao

| Test Case                          | Kết quả mong đợi                              |
|-------------------------------------|-----------------------------------------------|
| Session hết hạn                    | Tool tự login lại                             |
| Render 50 cảnh liên tục           | Không crash, log chính xác                    |
| Multi-tab 3 luồng                 | Tốc độ tăng 2-3 lần, không lỗi session        |
| Lỗi render                         | Retry 2 lần rồi ghi vào `failed_scenes.csv`  |
| Tự động ghép video                | Tạo `final_video.mp4` chính xác thứ tự       |
| Upload Drive                      | File được upload và trả về link              |
| Lập lịch                          | Tool tự chạy vào giờ đã đặt                  |
| Dọn bộ nhớ                         | Không còn tab rác, file tạm sau khi xong     |

---

## 🏁 Ghi chú triển khai
- Nên triển khai bản core ổn định rồi nâng cấp từng module Pro.  
- Với hệ thống lớn (100+ cảnh), nên dùng VPS riêng cho mỗi batch.  
- Giới hạn 3–5 tab render song song để tránh treo trình duyệt.  
- Backup log thường xuyên để tránh mất tiến trình khi crash.

